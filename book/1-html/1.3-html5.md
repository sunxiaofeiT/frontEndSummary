# HTML5

HTML5 现在已经不是 SGML 的子集，主要是关于图像，位置，存储，多任务等功能的增加。

## HTML5 新特性

绘画 canvas;

用于媒介回放的 video 和 audio 元素;

本地离线存储 localStorage 长期存储数据，浏览器关闭后数据不丢失;

sessionStorage 的数据在浏览器关闭后自动删除;

语意化更好的内容元素，比如 article、footer、header、nav、section;

表单控件，calendar、date、time、email、url、search;

新的技术webworker, websocket, Geolocation;

## HTML5 移除

1. 纯表现的元素：basefont，big，center，font, s，strike，tt，u。

2. 对可用性产生负面影响的元素：frame，frameset，noframes。

## Page Visibility API

### document.hidden

返回表示页面是否隐藏的布尔值。

### document.visibilityState

有下面 4 个可能状态的值：

1. hidden：页面在后台标签页中或者浏览器最小化

2. visible：页面在前台标签页中

3. prerender：页面在屏幕外执行预渲染处理 document.hidden 的值为 true

4. unloaded：页面正在从内存中卸载

### Visibilitychange事件

当文档从可见变为不可见或者从不可见变为可见时，会触发该事件。

这样，我们可以监听 Visibilitychange 事件，当该事件触发时，获取 document.hidden 的值，根据该值进行页面一些事件的处理。

## 离线存储

在线的情况下，浏览器发现html头部有manifest属性，它会请求manifest文件，如果是第一次访问app，那么浏览器就会根据manifest文件的内容下载相应的资源并且进行离线存储。如果已经访问过app并且资源已经离线存储了，那么浏览器就会使用离线的资源加载页面，然后浏览器会对比新的manifest文件与旧的manifest文件，如果文件没有发生改变，就不做任何操作，如果文件改变了，那么就会重新下载文件中的资源并进行离线存储。

离线的情况下，浏览器就直接使用离线存储的资源。

## HTML5 兼容

1. IE8/IE7/IE6支持通过 document.createElement 方法产生的标签，

    可以利用这一特性让这些浏览器支持HTML5新标签，浏览器支持新标签后，还需要添加标签默认的样式。

2. 直接使用成熟的框架、比如 html5shim。

例如：

```html
<!--[iflt IE 9]>
    <script>src="http://html5shim.googlecode.com/svn/trunk/html5.js"</script>
<![endif]-->
```

## 如何区分HTML5

- DOCTYPE声明

- 新增的结构元素

- 功能元素